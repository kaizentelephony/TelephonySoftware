
    const char *p = sip;
    const char *contactPos = NULL;
    
    // Find "Contact:" (case-insensitive)
    while (*p) {
        if (_strnicmp(p, "Contact:", 8) == 0) {
            contactPos = p + 8;
            break;
        }
        p++;
    }

    if (!contactPos)
        return 0;

    // Skip spaces
    while (*contactPos == ' ' || *contactPos == '\t')
        contactPos++;

    // If <sip:...>
    const char *start = strchr(contactPos, '<');
    const char *end   = NULL;

    if (start) {
        end = strchr(start, '>');
        if (!end)
            return 0;

        start++; // skip '<'
    } else {
        // No <> found, take till semicolon or end of line
        start = contactPos;
        end = start;
        while (*end && *end != ';' && *end != '\r' && *end != '\n')
            end++;
    }

    int len = end - start;
    if (len <= 0 || len >= outSize)
        return 0;

    strncpy(out, start, len);
    out[len] = '\0';
    return 1;

////////////////////////////////////////////

;

    char contact[256];

    if (get_contact_value(sipMsg, contact, sizeof(contact))) {
        printf("CONTACT VALUE: %s\n", contact);
    } else {
        printf("Contact header not found!\n");
    }
////////////////////////////////////////////
 if (!sip || !out) return 0;

    // ---- 1. Find start of real SIP message ----
    const char *real = strstr(sip, "SIP/2.0");
    if (!real)
        real = sip;  // fallback

    // ---- 2. Search for Contact: from real SIP ----
    const char *p = real;
    const char *contactPos = NULL;

    while (*p) {
        if (_strnicmp(p, "Contact:", 8) == 0) {
            contactPos = p + 8;
            break;
        }
        p++;
    }

    if (!contactPos)
        return 0;

    // ---- 3. Skip spaces ----
    while (*contactPos == ' ' || *contactPos == '\t')
        contactPos++;

    // ---- 4. Extract URI ----
    const char *start = strchr(contactPos, '<');
    const char *end = NULL;

    if (start) {
        end = strchr(start, '>');
        if (!end) return 0;
        start++;  // skip '<'
    }
    else {
        start = contactPos;
        end = start;
        while (*end && *end != ';' && *end != '\r' && *end != '\n')
            end++;
    }

    int len = (int)(end - start);
    if (len <= 0 || len >= outSize)
        return 0;

    strncpy(out, start, len);
    out[len] = '\0';
    return 1;
